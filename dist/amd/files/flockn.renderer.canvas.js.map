{"version":3,"sources":["src/renderer/canvas.js"],"names":[],"mappings":"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","file":"dist/amd/files/flockn.renderer.canvas.js","sourcesContent":["import {Vector2} from '../types';\nimport Graphics from '../graphics';\nimport createRootElement from '../graphics/rootelement';\nimport * as mouse from '../input/mouse';\n\nlet factory = () => {\n  Graphics.renderer = 'Canvas';\n\n  var rootElement = null;\n  var context = null;\n\n  Graphics.on('initialize', function (Game) {\n    rootElement = createRootElement.call(Game, 'canvas', function (rootElement) {\n      rootElement.width = Game.width;\n      rootElement.height = Game.height;\n      context = rootElement.getContext('2d');\n    });\n\n    mouse.events.forEach(function (eventName) {\n      rootElement.addEventListener(eventName, function (e) {\n        if (Game.activeScene) {\n          Game.activeScene.children\n            .all(obj => obj.visible && obj.bounds().contains(mouse.relativePosition(e, rootElement, obj)))\n            .forEach(obj => obj.trigger(eventName, mouse.relativePosition(e, rootElement, obj)));\n        }\n      });\n    });\n  });\n\n  Graphics.before('render', function (obj) {\n    switch (obj.type) {\n      case 'Game':\n        context.clearRect(0, 0, obj.width, obj.height);\n\n        context.fillStyle = obj.color.toString();\n        context.fillRect(0, 0, obj.width, obj.height);\n        break;\n      default:\n        break;\n    }\n  });\n\n  Graphics.on('render', function (obj) {\n    switch (obj.type) {\n      case 'GameObject':\n        context.save();\n\n        context.translate(obj.position.x + obj.origin.x, obj.position.y + obj.origin.y);\n\n        if (obj.angle !== 0) {\n          context.rotate(obj.angle * (Math.PI / 180));\n        }\n\n        if (obj.texture.backgroundColor.toString() !== 'transparent') {\n          context.fillStyle = obj.texture.backgroundColor.toString();\n          context.fillRect(-obj.origin.x, -obj.origin.y, obj.width, obj.height);\n        }\n\n        if (obj.texture.image.drawable) {\n          context.drawImage(obj.texture.image.data, -obj.origin.x, -obj.origin.y);\n        }\n\n        if (obj.texture.label.drawable) {\n          var fontName = obj.texture.label.font.size + 'px ' + obj.texture.label.font.name;\n\n          context.fillStyle = obj.texture.label.font.color.toString();\n          context.fillText(obj.texture.label.text, -obj.origin.x, -obj.origin.y);\n        }\n\n        context.restore();\n        break;\n      case 'Scene':\n        if (obj.parent.activeScene !== obj.name) {\n          return;\n        }\n        break;\n      default:\n        break;\n    }\n  });\n};\n\nexport default factory;\n"]}