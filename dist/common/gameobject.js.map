{"version":3,"sources":["src/gameobject.js"],"names":[],"mappings":"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","file":"src/gameobject.js","sourcesContent":["import Base from 'flockn/base';\r\nimport Behavior from 'flockn/behavior';\r\nimport Graphics from 'flockn/graphics';\r\nimport Group from 'flockn/group';\r\nimport Model from 'flockn/model';\r\nimport serialize from 'flockn/serialize';\r\nimport Texture from 'flockn/texture';\r\n\r\nimport {Vector2, Vector3, Color, Rect} from 'flockn/types';\r\n\r\nimport {addable, renderable, updateable, serializable} from 'flockn/mixins';\r\n\r\n\r\nclass GameObject extends Base {\r\n  constructor(descriptor) {\r\n    super('GameObject', descriptor);\r\n\r\n    this.visible = true;\r\n\r\n    this.position = new Vector3();\r\n\r\n    this.fitToTexture = true;\r\n\r\n    // Create a new texture and bind it to the `texture` property\r\n    this.texture = new Texture();\r\n    this.texture.parent = this;\r\n\r\n    // Once the image is loaded, update width and height if `fitToTexture` is set\r\n    this.texture.on('image-loaded', () => {\r\n      if (this.fitToTexture) {\r\n        this.width = this.texture.image.width;\r\n        this.height = this.texture.image.height;\r\n\r\n        this.origin.x = (this.width / 2);\r\n        this.origin.y = (this.height / 2);\r\n      }\r\n\r\n      // TODO: Evaluate if the Graphics trigger should only be in the texture\r\n      Graphics.trigger('texture-image-loaded', this, this.texture);\r\n    });\r\n\r\n    // Once the label is loaded, update width and height if `fitToTexture` is set\r\n    this.texture.on('label-loaded', () => {\r\n      if (this.fitToTexture) {\r\n        this.width = this.texture.label.width;\r\n        this.height = this.texture.label.height;\r\n\r\n        this.origin.x = (this.width / 2);\r\n        this.origin.y = (this.height / 2);\r\n\r\n        // TODO: Evaluate if the Graphics trigger should only be in the texture\r\n        Graphics.trigger('texture-label-loaded', this, this.texture);\r\n      }\r\n    });\r\n\r\n    this.width = 0;\r\n    this.height = 0;\r\n\r\n    this.angle = 0;\r\n\r\n    this.alpha = 1;\r\n\r\n    this.scale = new Vector2(1, 1);\r\n\r\n    this.origin = new Vector2(this.width / 2, this.width / 2);\r\n\r\n    this.border = {\r\n      width: 0,\r\n      color: new Color(),\r\n      radius: 0\r\n    };\r\n\r\n    // Add default model\r\n    var defaultModel = new Model();\r\n    defaultModel.name = 'default';\r\n\r\n    this.addModel(defaultModel);\r\n\r\n    // Mix in renderable and updateable\r\n    renderable.call(this);\r\n    updateable.call(this);\r\n  }\r\n\r\n  get left() {\r\n    return this.position.x;\r\n  }\r\n\r\n  set left(value) {\r\n    this.position.x = value;\r\n  }\r\n\r\n  get top() {\r\n    return this.position.y;\r\n  }\r\n\r\n  set top(value) {\r\n    this.position.y = value;\r\n  }\r\n\r\n  get right() {\r\n    return this.parent.width - this.width - this.position.x;\r\n  }\r\n\r\n  set right(value) {\r\n    this.position.x = this.parent.width - this.width - value;\r\n  }\r\n\r\n  get bottom() {\r\n    return this.parent.height - this.height - this.position.y;\r\n  }\r\n\r\n  set bottom(value) {\r\n    this.position.y = this.parent.height - this.height - value;\r\n  }\r\n\r\n  bounds() {\r\n    // TODO: Also take care of scale\r\n    // TODO: Also take care of rotation\r\n    return new Rect(this.position.x, this.position.y, this.width, this.height);\r\n  }\r\n\r\n  addGameObject() {\r\n    // Add a game object to this game object\r\n    this.queue.push(addable(GameObject, this.children).apply(this, arguments));\r\n  }\r\n\r\n  addBehavior() {\r\n    // Add a `Behavior` instance to the the game object and update the `gameObject` property\r\n    this.queue.push(addable(Behavior, this.children, function(child) {\r\n      child.gameObject = this;\r\n    }).apply(this, arguments));\r\n  }\r\n\r\n  addModel() {\r\n    // Add a `Model` instance to the game object\r\n    this.queue.push(addable(Model, this.children).apply(this, arguments));\r\n  }\r\n\r\n  removeGameObject() {\r\n\r\n  }\r\n\r\n  removeBehavior() {\r\n\r\n  }\r\n\r\n  removeModel() {\r\n\r\n  }\r\n\r\n  data(name) {\r\n    if (!name) {\r\n      return this.models.byName('default');\r\n    } else {\r\n      return this.models.byName(name);\r\n    }\r\n  }\r\n\r\n  animate(property, end, time, callback) {\r\n    // TODO: Tweening does not work yet\r\n    if ( typeof this[property] === 'number') {\r\n      var distance = end - this[property];\r\n      var timeInS = (time / 1000);\r\n\r\n      var animateName = 'animate-' + Date.now();\r\n      this.on(animateName, function(dt) {\r\n\r\n        this.off(animateName);\r\n      });\r\n    }\r\n  }\r\n\r\n  static fromString() {\r\n\r\n  }\r\n}\r\n\r\nserializable(GameObject);\r\n\r\nexport default GameObject;\r\n"]}