{"version":3,"sources":["src/gameobject.js"],"names":[],"mappings":"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","file":"src/gameobject.js","sourcesContent":["import Base from 'flockn/base';\nimport Behavior from 'flockn/behavior';\nimport Graphics from 'flockn/graphics';\nimport Group from 'flockn/group';\nimport Model from 'flockn/model';\nimport serialize from 'flockn/serialize';\nimport Texture from 'flockn/texture';\n\nimport {Vector2, Vector3, Color, Rect} from 'flockn/types';\n\nimport {addable, renderable, updateable, serializable, storable} from 'flockn/mixins';\n\n\nclass GameObject extends Base {\n  constructor(descriptor) {\n    super('GameObject', descriptor);\n\n    this.visible = true;\n\n    this.position = new Vector3();\n\n    this.fitToTexture = true;\n\n    // Create a new texture and bind it to the `texture` property\n    this.texture = new Texture();\n    this.texture.parent = this;\n\n    // Once the image is loaded, update width and height if `fitToTexture` is set\n    this.texture.on('image-loaded', () => {\n      if (this.fitToTexture) {\n        this.width = this.texture.image.width;\n        this.height = this.texture.image.height;\n\n        this.origin.x = (this.width / 2);\n        this.origin.y = (this.height / 2);\n      }\n\n      // TODO: Evaluate if the Graphics trigger should only be in the texture\n      Graphics.trigger('texture-image-loaded', this, this.texture);\n    });\n\n    // Once the label is loaded, update width and height if `fitToTexture` is set\n    this.texture.on('label-loaded', () => {\n      if (this.fitToTexture) {\n        this.width = this.texture.label.width;\n        this.height = this.texture.label.height;\n\n        this.origin.x = (this.width / 2);\n        this.origin.y = (this.height / 2);\n\n        // TODO: Evaluate if the Graphics trigger should only be in the texture\n        Graphics.trigger('texture-label-loaded', this, this.texture);\n      }\n    });\n\n    this.width = 0;\n    this.height = 0;\n\n    this.angle = 0;\n\n    this.alpha = 1;\n\n    this.scale = new Vector2(1, 1);\n\n    this.origin = new Vector2(this.width / 2, this.width / 2);\n\n    this.border = {\n      width: 0,\n      color: new Color(),\n      radius: 0\n    };\n\n    // Add default model\n    var defaultModel = new Model();\n    defaultModel.name = 'default';\n\n    this.addModel(defaultModel);\n\n    // Mix in renderable and updateable\n    renderable.call(this);\n    updateable.call(this);\n  }\n\n  get left() {\n    return this.position.x;\n  }\n\n  set left(value) {\n    this.position.x = value;\n  }\n\n  get top() {\n    return this.position.y;\n  }\n\n  set top(value) {\n    this.position.y = value;\n  }\n\n  get right() {\n    return this.parent.width - this.width - this.position.x;\n  }\n\n  set right(value) {\n    this.position.x = this.parent.width - this.width - value;\n  }\n\n  get bottom() {\n    return this.parent.height - this.height - this.position.y;\n  }\n\n  set bottom(value) {\n    this.position.y = this.parent.height - this.height - value;\n  }\n\n  bounds() {\n    // TODO: Also take care of scale\n    // TODO: Also take care of rotation\n    return new Rect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  addGameObject() {\n    // Add a game object to this game object\n    this.queue.push(addable(GameObject, this.children).apply(this, arguments));\n  }\n\n  addBehavior() {\n    // Add a `Behavior` instance to the the game object and update the `gameObject` property\n    this.queue.push(addable(Behavior, this.children, function(child) {\n      child.gameObject = this;\n    }).apply(this, arguments));\n  }\n\n  addModel() {\n    // Add a `Model` instance to the game object\n    this.queue.push(addable(Model, this.children).apply(this, arguments));\n  }\n\n  removeGameObject() {\n\n  }\n\n  removeBehavior() {\n\n  }\n\n  removeModel() {\n\n  }\n\n  data(name) {\n    if (!name) {\n      return this.models.byName('default');\n    } else {\n      return this.models.byName(name);\n    }\n  }\n\n  animate(property, end, time, callback) {\n    // TODO: Tweening does not work yet\n    if ( typeof this[property] === 'number') {\n      var distance = end - this[property];\n      var timeInS = (time / 1000);\n\n      var animateName = 'animate-' + Date.now();\n      this.on(animateName, function(dt) {\n\n        this.off(animateName);\n      });\n    }\n  }\n\n  static fromString() {\n\n  }\n}\n\nserializable(GameObject);\nstorable(GameObject);\n\nexport default GameObject;\n"]}