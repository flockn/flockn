{"version":3,"sources":["src/renderer/canvas.js"],"names":[],"mappings":"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","file":"src/renderer/canvas.js","sourcesContent":["import {Vector2} from 'flockn/types';\r\nimport Graphics from 'flockn/graphics';\r\nimport createRootElement from 'flockn/graphics/rootelement';\r\nimport * as mouse from 'flockn/input/mouse';\r\n\r\nGraphics.renderer = 'Canvas';\r\n\r\nvar rootElement = null;\r\nvar context = null;\r\n\r\nGraphics.on('initialize', function(Game) {\r\n  rootElement = createRootElement.call(Game, 'canvas', function(rootElement) {\r\n    rootElement.width = Game.width;\r\n    rootElement.height = Game.height;\r\n    context = rootElement.getContext('2d');\r\n  });\r\n\r\n  mouse.events.forEach(function(eventName) {\r\n    rootElement.addEventListener(eventName, function(e) {\r\n      if (Game.activeScene) {\r\n        Game.activeScene.children\r\n          .all(obj => obj.visible && obj.bounds().contains(mouse.relativePosition(e, rootElement, obj)))\r\n          .forEach(obj => obj.trigger(eventName, mouse.relativePosition(e, rootElement, obj)));\r\n      }\r\n    });\r\n  });\r\n});\r\n\r\nGraphics.before('render', function(obj) {\r\n  switch (obj.type) {\r\n  case 'Game':\r\n    context.clearRect(0, 0, obj.width, obj.height);\r\n\r\n    context.fillStyle = obj.color.toString();\r\n    context.fillRect(0, 0, obj.width, obj.height);\r\n    break;\r\n  default:\r\n    break;\r\n  }\r\n});\r\n\r\nGraphics.on('render', function(obj) {\r\n  switch (obj.type) {\r\n  case 'GameObject':\r\n    context.save();\r\n\r\n    context.translate(obj.position.x + obj.origin.x, obj.position.y + obj.origin.y);\r\n\r\n    if (obj.angle !== 0) {\r\n      context.rotate(obj.angle * (Math.PI / 180));\r\n    }\r\n\r\n    if (obj.texture.backgroundColor.toString() !== 'transparent') {\r\n      context.fillStyle = obj.texture.backgroundColor.toString();\r\n      context.fillRect(-obj.origin.x, -obj.origin.y, obj.width, obj.height);\r\n    }\r\n\r\n    if (obj.texture.image.drawable) {\r\n      context.drawImage(obj.texture.image.data, -obj.origin.x, -obj.origin.y);\r\n    }\r\n\r\n    if (obj.texture.label.drawable) {\r\n      var fontName = obj.texture.label.font.size + 'px ' + obj.texture.label.font.name;\r\n\r\n      context.fillStyle = obj.texture.label.font.color.toString();\r\n      context.fillText(obj.texture.label.text, -obj.origin.x, -obj.origin.y);\r\n    }\r\n\r\n    context.restore();\r\n    break;\r\n  case 'Scene':\r\n    if (obj.parent.activeScene !== obj.name) {\r\n      return;\r\n    }\r\n    break;\r\n  default:\r\n    break;\r\n  }\r\n});\r\n"]}