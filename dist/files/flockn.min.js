udefine("flockn/addable",["./graphics"],function(a){"use strict";return function(b,c,d){var e=function(){var e=arguments[0],f=2<=arguments.length?[].slice.call(arguments,1):[];e instanceof b||("string"==typeof e?Object.hasOwnProperty.call(store,e)&&(e=new b(b.store[e])):e=new b("function"==typeof e?e:function(){Object.keys(e).forEach(function(a){this[a]=e[a]},this)})),c.push(e),e.parent=this,d&&d.call(this,e),a.trigger("add",e),e.apply(f),e.trigger("add",e,f)};return function(){var a=[].slice.call(arguments);return a.unshift(this),e.bind.apply(e,a)}}}),udefine("flockn/base",["eventmap","mixedice","gameboard/input","./group","./world"],function(a,b,c,d,e){"use strict";var f=0,g=1e4,h=function(a){var b=a+"";if(a>=g)return b;for(var c=(g+"").length-b.length,d=0;c>d;d++)b="0"+b;return b},i=function(g,j){b([this,i.prototype],new a),g=g||"Base",this.type=g,this.name=this.type+"-"+Date.now();var k=h(++f);Object.defineProperty(this,"id",{get:function(){return this.type+"-"+k},enumerable:!0}),this.descriptor=j,this.children=new d,this.queue=[],this.parent=null,this.input=c,this.world=e,this.trigger("constructed")};return i.prototype.call=i.prototype.reset=function(){this.apply(arguments)},i.prototype.apply=function(a){this.descriptor&&(a=a||[],this.descriptor.apply(this,a),this.trigger("execute"),this.queue.forEach(function(a){a&&a()}),this.queue=[])},i.prototype.log=function(){if(console&&console.log){var a=[].slice.call(arguments);return a.unshift(":"),a.unshift(this.name),a.unshift(this.type),console.log.apply(console,a)}},i.extend=function(a,c,d){var e=new i(c,d);b(a,e)},i}),udefine("flockn/behavior",["mixedice","./addable","./base","./group","./updateable"],function(a,b,c,d,e){"use strict";var f=function(a){c.extend([this,f.prototype],"Behavior",a),this.gameObject=null,e.call(this)};return f.prototype.addBehavior=function(){this.queue.push(b(f,this.children,function(a){a.gameObject=this.gameObject}).apply(this,arguments))},f.store={},f.define=function(a,b){f.store[a]=b},f}),udefine("flockn/game",["root","mixedice","gameboard/loop","./addable","./base","./graphics","./scene","./renderable","./updateable"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(b){if(!this||!this instanceof j)return new j(b);var d=this;e.extend([this,j.prototype],"Game",function(){b.call(this),f.trigger("initialize",this)}),this.container=null,this.width=a.innerWidth,this.height=a.innerHeight,this.color="rgb(255, 255, 255)",this.activeScene=null,this.call(),h.call(this),i.call(this),c.on("update",function(a){d.trigger("update",a/1e3)}),c.on("render",function(){d.trigger("render")}),a.addEventListener("resize",function(){d.trigger("resize")},!1),a.addEventListener("orientationchange",function(){d.trigger("orientationchange")},!1)};return j.prototype.addScene=function(){this.queue.push(d(g,this.children,function(a){a.width=this.width,a.height=this.height}).apply(this,arguments))},j.prototype.showScene=function(a){this.activeScene=a,this.trigger("show",this.activeScene,this.children[this.activeScene])},j.prototype.run=function(a){c.run(),a||1===this.children.length&&(a=this.children[0].name),a&&this.showScene(a)},j}),udefine("flockn/gameobject",["mixedice","./addable","./base","./behavior","./graphics","./group","./model","./renderable","./serialize","./texture","./updateable"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=function(a){c.extend([this,l.prototype],"GameObject",a);var b=this;this.visible=!0,this.x=0,this.y=0,Object.defineProperty(this,"left",{get:function(){return this.x},set:function(a){this.x=a},enumerable:!0}),Object.defineProperty(this,"top",{get:function(){return this.y},set:function(a){this.y=a},enumerable:!0}),Object.defineProperty(this,"right",{get:function(){return this.parent.width-this.width-this.x},set:function(a){this.x=this.parent.width-this.width-a},enumerable:!0}),Object.defineProperty(this,"bottom",{get:function(){return this.parent.height-this.height-this.y},set:function(a){this.y=this.parent.height-this.height-a},enumerable:!0}),this.fitToTexture=!0,this.texture=new j,this.texture.parent=this,this.texture.on("image-loaded",function(){b.fitToTexture&&(b.width=b.texture.image.width,b.height=b.texture.image.height,b.origin.x=b.width/2,b.origin.y=b.height/2),e.trigger("texture-image-loaded",b,b.texture)}),this.texture.on("label-loaded",function(){b.fitToTexture&&(b.width=b.texture.label.width,b.height=b.texture.label.height,b.origin.x=b.width/2,b.origin.y=b.height/2,e.trigger("texture-label-loaded",b,b.texture))}),this.width=0,this.height=0,this.angle=0,this.alpha=1,this.scale={x:1,y:1},this.origin={x:b.width/2,y:b.width/2},this.border={width:0,color:"rgb(0, 0, 0)",radius:0},this.behaviors=new f,this.models=new f,h.call(this),k.call(this),this.on("update",function(){b.behaviors.forEach(function(a){a.trigger("update")})})};return l.store={},l.define=function(a,b){l.store[a]=b},l.prototype.addGameObject=function(){this.queue.push(b(l,this.children).apply(this,arguments))},l.prototype.addBehavior=function(){this.queue.push(b(d,this.behaviors,function(a){a.gameObject=this}).apply(this,arguments))},l.prototype.addModel=function(){this.queue.push(b(g,this.models).apply(this,arguments))},l.prototype.toJSON=function(){return i(this)},l.prototype.fromJSON=function(){},l.prototype.animate=function(a,b,c){if("number"==typeof this[a]){var d=(b-this[a],"animate-"+Date.now());this.on(d,function(){this.off(d)})}},l}),udefine("flockn/graphics",["eventmap"],function(a){"use strict";var b=new a;return Object.defineProperty(b,"renderer",{value:null,writable:!0,enumerable:!0}),b}),udefine("flockn/graphics/rootelement",function(){"use strict";return function(a,b){var c=function(){return null==this.container?(this.container=this.id,this.container):0===this.container.indexOf("#")?this.container.slice(1):void 0}.call(this);this.width=this.width||window.innerWidth,this.height=this.height||window.innerHeight;var d=document.getElementById(c);if(null==d){var e=document.createElement(a);e.id=c.toLowerCase(),document.body.appendChild(e),d=e}return d.className=[this.type.toLowerCase(),this.name.toLowerCase()].join(" "),d.style.position="absolute",d.style.width=this.width+"px",d.style.height=this.height+"px",b.call(this,d),this.width<window.innerWidth&&(d.style.left="50%",d.style.marginLeft=this.width*-.5+"px"),this.height<window.innerHeight&&(d.style.top="50%",d.style.marginTop=this.width*-.5+"px"),d}}),udefine("flockn/group",["./serialize"],function(a){"use strict";var b="untitled",c=0,d=function(){this.length=0,this.tags={},this.names={}};return d.prototype.push=function(a,d){var e=a.name||b+c++;return null==d&&(d=a.tags||[]),Object.hasOwnProperty.call(this.names,e)?void 0:(this[this.length]=a,Object.keys(this.tags).forEach(function(a){this.tags[a]=this.tags[a]||[],this.tags[a].push(this.length)},this),this.names[e]=this.length,++this.length)},d.prototype.pop=function(){return this[this.length]},d.prototype.splice=function(){},d.prototype.slice=function(a,b){null==b&&(b=this.length);for(var c=new d,e=a;b>e;e++)c.push(this[e]);return c},d.prototype.forEach=function(a){for(var b=0;b<this.length;b++)a(this[b])},d.prototype.map=function(a){for(var b=[],c=0;c<this.length;c++)b.push(a(this[c]));return b},d.prototype.filter=function(a){for(var b=[],c=0;c<this.length;c++)a(this[c])&&b.push(this[c]);return b},d.prototype.byName=function(a){return this[this.names[a]]},d.prototype.byTag=function(a){return this.tags[a].map(function(a){return this[a]},this)},d.prototype.toJSON=function(){return a(this)},d}),udefine("flockn/model",["mixedice","eventmap"],function(a,b){"use strict";var c=function(){a([this,c.prototype],new b),this.data={}};return c.prototype.get=function(a){return Object.hasOwnProperty.call(this.data,a)?this.data[a]:void 0},c.prototype.set=function(a,b){this.data[a]=b,this.trigger("change",a,b)},c}),udefine("flockn/renderable",["./graphics"],function(a){"use strict";return function(){var b=this;this.on("render",function(){a.trigger("render",b),b.children.forEach(function(a){a.trigger("render")})})}}),udefine("flockn/scene",["mixedice","./addable","./base","./group","./gameobject","./renderable","./updateable"],function(a,b,c,d,e,f,g){"use strict";var h=function(a){c.extend([this,h.prototype],"Scene",a),f.call(this),g.call(this)};return h.prototype.addGameObject=function(){this.queue.push(b(e,this.children).apply(this,arguments))},h.store={},h.define=function(a,b){h.store[a]=b},h}),udefine("flockn/serialize",function(){"use strict";return function(a){return JSON.stringify(a,function(a,b){return"parent"!==a?("descriptor"===a&&(b=b.toString()),b):void 0})}}),udefine("flockn/texture",["mixedice","eventmap"],function(a,b){"use strict";var c=function(){a([this,c.prototype],new b);var d=this;this.width=0,this.height=0,this.parent=null,this.image={color:"rgb(255, 255, 255)",offset:{x:0,y:0},data:null,width:0,height:0};var e="";Object.defineProperty(this.image,"filename",{get:function(){return e},set:function(a){e=a;var b=new Image;b.src=e,b.onload=function(){d.image.data=b,d.image.width=b.width,d.image.height=b.height,d.trigger("image-loaded")}},enumerable:!0}),this.label={font:{size:10,name:"Arial",color:"rgb(0, 0, 0)",decoration:[]},align:{x:"center",y:"center"},width:0,height:0};var f="";Object.defineProperty(this.label,"text",{get:function(){return f},set:function(a){f=a;var b=document.createElement("div");b.innerText=f,b.style.position="absolute",b.style.left="-9999px",b.style.top="-9999px",b.style.fontSize=d.label.font.size+"px",b.style.fontFamily=d.label.font.name,b.style.color=d.label.font.color,d.label.font.decoration.forEach(function(a){switch(a){case"bold":b.style.fontWeight="bold";break;case"italic":b.style.fontStyle="italic";break;case"underline":b.style.textDecoration="underline"}}),document.body.appendChild(b),d.label.width=b.clientWidth,d.label.height=b.clientHeight,document.body.removeChild(b),d.trigger("label-loaded")}}),this.color="transparent"};return c}),udefine("flockn/updateable",function(){"use strict";return function(){var a=this;this.on("update",function(b){a.children.forEach(function(a){a.trigger("update",b)})})}}),udefine("flockn/world",["./model"],function(a){"use strict";var b=new a;return b});