udefine("flockn/renderer/dom",["root","../graphics","../graphics/rootelement"],function(a,b,c){"use strict";var d=function(a){return a+"px"},e=function(a){return parseFloat(a)||0};b.renderer="DOM";var f=null;b.on("initialize",function(a){f=c.call(a,"div",function(a){a.style.backgroundColor=this.color.toString(),a.style.overflow="hidden",a.style.cursor="default",a.style.userSelect=a.style.mozUserSelect=a.style.webkitUserSelect="none"})}),b.on("add",function(b){var c=b.id.toLowerCase();null!=document.getElementById(c)&&!function(){var a=b.parent.id.toLowerCase(),d=document.getElementById(a);d.removeChild(document.getElementById(c))}();var e=b.parent,g=function(){if(e&&e.isRoot||null==e)return f;var a=b.parent.id.toLowerCase(),c=document.getElementById(a);return null==c?f:c}(),h=document.createElement("div");switch(h.id=c,h.className=[b.type.toLowerCase(),b.name.toLowerCase()].join(" "),h.style.position="absolute",b.type){case"Scene":h.style.width=d(b.parent.width),h.style.height=d(b.parent.height);break;case"GameObject":h.style.left=d(b.x),h.style.top=d(b.y),h.style.width=d(b.width),h.style.height=d(b.height),a.addEventListener("click",function(a){b.trigger("click",a)},!0),a.addEventListener("mousedown",function(a){b.trigger("mousedown",a)},!0),a.addEventListener("mouseup",function(a){b.trigger("mouseup",a)},!0),a.addEventListener("mouseenter",function(a){b.trigger("mouseenter",a)},!0),a.addEventListener("mouseleave",function(a){b.trigger("mouseleave",a)},!0),a.addEventListener("mouseover",function(a){b.trigger("mouseover",a)},!0)}g.appendChild(h)}),b.on("texture-image-loaded",function(a,b){var c=document.getElementById(a.id.toLowerCase());null!=c&&(c.style.backgroundImage="url("+b.image.filename+")",c.style.width=d(a.width),c.style.height=d(a.height))}),b.on("texture-label-loaded",function(a){var b=document.getElementById(a.id.toLowerCase());null!=b&&(b.style.width=d(a.width),b.style.height=d(a.height))});var g={};return b.after("render",function(a){var b=a.id.toLowerCase();g[b]=a}),b.on("render",function(a){var b=a.id.toLowerCase(),c=document.getElementById(b);if(null!=c){{g[b]||{}}switch(a.type){case"GameObject":var f="block"===c.style.display;if(f!==a.visible&&(c.style.display=a.visible?"block":"hidden"),!f)return;var h=e(c.style.left),i=e(c.style.top),j=e(c.style.width),k=e(c.style.height);h!==a.x&&(c.style.left=d(a.x)),i!==a.y&&(c.style.top=d(a.y)),j!==a.width&&(c.style.width=d(a.width)),k!==a.height&&(c.style.height=d(a.height)),a.angle&&(c.style.transform=c.style.mozTransform=c.style.webkitTransform="rotate("+a.angle+"deg)"),1!==a.alpha&&(c.style.opacity=a.alpha),c.style.backgroundColor=a.texture.color.toString(),c.style.transformOrigin=c.style.mozTransformOrigin=c.webkitTransformOrigin=a.origin.x+"px "+a.origin.y+"px",a.border.width>0&&(c.style.borderWidth=d(a.border.width),c.style.borderStyle="solid",c.style.borderColor=a.border.color.toString(),a.border.radius>0&&(c.style.borderRadius=d(a.border.radius))),a.texture.image.drawable&&(0!==a.texture.image.offset.x&&(c.style.backgroundPositionX=-1*a.texture.image.offset.x+"px"),0!==a.texture.image.offset.y&&(c.style.backgroundPositionY=-1*a.texture.image.offset.y+"px")),a.texture.label.drawable&&(c.innerText=a.texture.label.text,c.style.whiteSpace="nowrap",a.texture.label.font.size&&(c.style.fontSize=d(a.texture.label.font.size)),a.texture.label.font.color&&(c.style.color=a.texture.label.font.color.toString()),a.texture.label.font.name&&(c.style.fontFamily=a.texture.label.font.name),a.texture.label.font.decoration.forEach(function(a){switch(a){case"bold":c.style.fontWeight="bold";break;case"italic":c.style.fontStyle="italic";break;case"underline":c.style.textDecoration="underline"}}));break;case"Scene":var l=c.style.display;a.parent.activeScene!==a.name?"hidden"!==l&&(c.style.display="hidden"):"block"!==l&&(c.style.display="block")}}}),b});